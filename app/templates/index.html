 <!DOCTYPE html>
<html lang="fr">
 <head>
     <meta charset="UTF-8">
     <title>Traduction et doublage vidéo</title>
     <link rel="stylesheet" href="/static/style.css">
 </head>
 <body>
 <h1>Traduction et doublage vidéo</h1>
 {% if is_editor %}
 <div id="role-indicator" style="background: #007bff; color: white; padding: 10px; margin-bottom: 20px;">
     Mode Éditeur actif
 </div>
 {% else %}
 <div id="role-indicator" style="background: #28a745; color: white; padding: 10px; margin-bottom: 20px;">
     Mode Public actif
 </div>
 {% endif %}
 
 {% if is_editor %}
 <section id="upload" style="display: block;">
     <h2>Télécharger une nouvelle vidéo</h2>
     <form id="upload-form">
         <fieldset>
             <legend>Dossier (optionnel)</legend>
             <label>
                 Chemin du dossier :
                 <input type="text" name="folder_path" placeholder="ex: projets/2024" id="folder-path-input">
                 <button type="button" id="create-folder-btn">Créer un nouveau dossier</button>
             </label>
             <label>
                 <input type="checkbox" name="is_private" id="is-private-checkbox">
                 Privé (visible uniquement par les éditeurs)
             </label>
         </fieldset>
         <label>Fichier vidéo :
             <input type="file" name="file" accept="video/*" required>
         </label>
         <fieldset>
             <legend>Langues cibles (max. 2)</legend>
             {% for lang in available_languages %}
             <label>
                 <input type="checkbox" name="languages" value="{{ lang.code }}">
                 {{ lang.label }}{% if lang.provider == "ai" %}*{% endif %}
             </label>
             {% endfor %}
             <p class="language-hint">Les langues marquées d'un * utilisent le traducteur IA, les autres passent par DeepL.</p>
             <p class="language-hint">Lingala, Tshiluba, Kikongo et Malagasy ne proposent pour l'instant que des sous-titres.</p>
         </fieldset>
        <fieldset>
            <legend>Options de traitement</legend>
            <label>
                <input type="checkbox" name="process_options" value="subs_per_language" checked>
                Sous-titres séparés par langue
            </label>
            <label>
                 <input type="checkbox" name="process_options" value="subs_combined" checked>
                 Sous-titres combinés
             </label>
             <label>
                 <input type="checkbox" name="process_options" value="dub_audio" checked>
                 Audio de doublage (MP3)
             </label>
             <label>
                 <input type="checkbox" name="process_options" value="dub_video" checked>
                 Vidéo avec doublage audio
             </label>
            <p class="language-hint">Décochez les options inutiles pour éviter un traitement superflu.</p>
        </fieldset>
        <fieldset>
            <legend>Synchronisation du doublage</legend>
            <label>
                Vitesse relative de la voix TTS
                <input
                    type="number"
                    name="tts_speed_multiplier"
                    value="1.05"
                    min="0.8"
                    max="1.2"
                    step="0.01"
                >
            </label>
            <p class="language-hint">
                1,00 = vitesse normale. Augmentez légèrement (ex. 1,05) pour que la voix doublée démarre plus tôt.
            </p>
        </fieldset>
        <button type="submit">Téléverser et traiter</button>
    </form>
     <div id="upload-status"></div>
 </section>
 {% else %}
 <section id="upload" style="display: none;"></section>
 {% endif %}
 
 <hr>
 
 <section id="library">
     <h2>Bibliothèque</h2>
     {% if is_editor %}
     <div id="folder-management">
         <button type="button" id="create-folder-btn-top">Créer un nouveau dossier</button>
     </div>
     {% endif %}
     <div id="video-list"></div>
 </section>
 
 <section id="player">
     <h2>Lecteur</h2>
     <div id="video-container">
         <video id="video-player" controls width="800">
             Votre navigateur ne supporte pas la balise vidéo.
         </video>
         <div id="subtitle-overlay" class="hidden"></div>
     </div>
     <div id="player-actions">
         <button type="button" id="fullscreen-button">[ ] Plein écran</button>
     </div>
     <div id="player-info"></div>
 </section>
 
 <script src="/static/app.js"></script>
 </body>
 </html>

)
